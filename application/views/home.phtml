
<!-- Make sure you put this AFTER Leaflet's CSS -->
 <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
    
<!--Script-->
    <script defer type="module" src="./script/module/Position.js"></script>
    <script defer type="module" src="./script/module/ListPoint.js"></script>
    <script defer type="module" src="./script/module/SearchBar.js"></script>
    
    <script defer type="module" src="./script/home.js"></script>
    <!--<script defer type="text/javascript" src="script/map.js"></script>-->


<div id="searchbar" class="searchbar">
    <span>
        <input class="searchbar-input" type="text" name="search_adress" placeholder="recherche">
        <span><i class="fa-regular fa-circle-xmark"></i></span> 
    </span>
    <ul class="searchbar-results"></ul>
</div>

<div id="listpoint" data-value='<?= (isset($_POST['my_route'])) ? str_replace("'","",$_POST['my_route']) : null;?>'
                    data-name=''
    ><!--attion guillement simple !  "'" remplacer par "vide"   -->


    <!--<div class="drag-bar"></div>-->


    <div class="position">
        <span>Votre position</span>
    </div>


    <ul>
        <!--list of point-->
    </ul>
    <template> <!--template of point-->
        <li class="point" draggable="true">
            
            <span class='label'>
                <!--label of point-->
            </span>
            <span class="remove" data-index="" style="display: none;">
                <i class="fa-solid fa-circle-xmark"></i>
            </span>
        </li>
    </template>

    <div class="total">
        <span>Total : 26km / 1h34</span>
        
    <?php if(isset($_SESSION['user'])): ?>
        <form method="post" action="./my-routes"> 
            <input type="hidden" name="listpoint" value="">
            <input type="hidden" name="name" value=''>
            <button type="button">Save</button>
        </form>
    <?php endif; ?>
    </div>


    
</div>

<div id="local_map">
    
    <script>// L'id du container, par exemple <div id="map"></div>
        var mapID = 'local_map';
        
        // Photographies aériennes en-dessous de Plan IGN
        var OrthoIGN = L.tileLayer('https://wxs.ign.fr/{ignApiKey}/geoportail/wmts?' +
            '&REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&TILEMATRIXSET=PM' +
            '&LAYER={ignLayer}&STYLE={style}&FORMAT={format}' +
            '&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}', {
                ignApiKey: 'decouverte',
                ignLayer: 'ORTHOIMAGERY.ORTHOPHOTOS',
                style: 'normal',
                format: 'image/jpeg',
                service: 'WMTS',
        
            });
        
        // Plan IGN avec une transparence de 50%
        var PlanIGN = L.tileLayer('https://wxs.ign.fr/{ignApiKey}/geoportail/wmts?' +
            '&REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&TILEMATRIXSET=PM' +
            '&LAYER={ignLayer}&STYLE={style}&FORMAT={format}' +
            '&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}', {
                ignApiKey: 'decouverte',
                ignLayer: 'GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2',
                style: 'normal',
                format: 'image/png',
                service: 'WMTS',
                opacity: 0.7,
                attribution: ', Carte © IGN-F/Geoportail'
            });
        
        // Plan OpenStreetMap_France avec une transparence de 70%
        var OpenStreetMap_France = L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
            maxZoom: 20,
            opacity: 0.7,
            attribution: '&copy; OpenStreetMap France | &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        });
        
        
        
        // var largeurEcran = window.screen.width;
        // console.log("Largeur de l'écran : " + largeurEcran);
        // var zoom = ((window.screen.width >= 1024) ? 6 : 5) ;
        // if (largeurEcran> 1024){
        //     zoom = 6;
        // }
        
        
        
        // Ma carte
        var local_map = L.map(mapID, {
            center: [46.1, 1.7],
            zoom: ((window.screen.width >= 768) ? 6 : 5),
            layers: [OpenStreetMap_France],
            // zoomControl: false,
            // watch: true,
            // setView: true,
            // animate: true,
        });
        
        
        //Boite de recherche geocode
        // var geocoder = L.geocoderBAN({ collapsed: false }).addTo(myMap)
        
        
        
        // var position = L.Control.handler().addTo(local_map).setPosition('topleft')
        
        
        var baseMaps = {
            "OsmFrance": OpenStreetMap_France,
            "PlanIGN": PlanIGN,
            "OrthoIGN": OrthoIGN,
        };
        // var overlayMaps = {
        //     "Cities": cities
        // };
        var layers_control = L.control.layers(baseMaps).addTo(local_map).setPosition('topleft');
        
        var scale_control = L.control.scale({imperial:false}).addTo(local_map).setPosition('topleft');
        
        // var zoom_control = L.control.zoom().addTo(local_map).setPosition('topleft');
        
        
    
        
    </script>
</div>

